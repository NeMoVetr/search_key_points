# Исследовательская работа по сравнению методов выделения ключевых точек при искажении изображения

Данный проект посвящён сравнительному анализу методов выделения ключевых точек и сопоставления дескрипторов при различных искажениях изображения. В работе используются классические алгоритмы для обнаружения и описания ключевых точек, а также методы сопоставления, позволяющие оценить качество обнаружения при изменении характеристик изображения (яркость, контраст, размытие).
Сама работа представлена в pdf файле

## Используемые методы

### Детекторы/Дескрипторы

- **ORB** – Быстрый и эффективный алгоритм, объединяющий методы обнаружения и описания.
- **FAST** – Алгоритм для быстрого обнаружения угловых точек.
- **KAZE** – Детектор, основанный на нелинейном диффузионном пространстве.
- **AKAZE** – Улучшенная версия KAZE для ускорения расчётов.
- **AGAST** – Детектор, похожий на FAST, но с улучшенной стабильностью.
- **GFTT** – Детектор, основанный на анализе углов.
- **MSER** – Детектор экстремальных регионов в изображении.
- **SIFT** – Классический алгоритм, обеспечивающий высокую точность, но с более высокой вычислительной сложностью.

*Примечание:* Для некоторых методов, таких как FAST и GFTT, применяется дополнительный дескриптор (ORB/BRISK) для вычисления описаний ключевых точек. Перебираются всевозможные вариации Дескрипторы и алгоритмов сопоставления

### Алгоритмы сопоставления

- **BF_L2** – Жёсткий перебор с использованием L2-нормы.
- **NORM_HAMMING2** – Использует расстояние Хэмминга.
- **NORM_L2SQR** – Альтернативное вычисление L2-нормы в квадрате.
- **FLANN (FLANN_LSH, FLANN_KDTree, FLANN_KMeans)** – Алгоритмы поиска ближайших соседей для ускорения сопоставления при больших объёмах данных.

## Структура проекта

- **search_points.py** – Основной файл запуска, содержащий все функции для инициализации методов, оценки и сопоставления ключевых точек.
- **generegate_dataset.py** – Модуль для загрузки и подготовки искажённых изображений.
- **create_visualisation.py** – Модуль для построения графиков и визуализации результатов.
- **initializer.py** – Модуль для инициализации детекторов, дескрипторов и алгоритмов сопоставления.

## Описание работы алгоритма

1. **Инициализация методов:**  
   Функция `initialize_methods()` создаёт словари с детекторами, дополнительными дескрипторами и алгоритмами сопоставления (как BFMatcher, так и FLANN Matcher).

2. **Обнаружение и сопоставление ключевых точек:**  
   Функция `evaluate_methods()` проходит по всем возможным комбинациям детектора (с возможным дополнительным дескриптором для FAST и GFTT) и алгоритма сопоставления. На каждом шаге производится:
   - Обнаружение ключевых точек.
   - Вычисление дескрипторов (либо встроенным методом, либо внешним дескриптором).
   - Сопоставление дескрипторов с использованием выбранного алгоритма.

3. **Оценка результатов:**  
   Для каждой комбинации вычисляются следующие метрики:
   - **Количество соответствий** – общее число найденных пар.
   - **Коэффициент удачных соответствий** – определяется с помощью теста Лоу (`lowes_ratio_test`).
   - **Коэффициент найденных точек** – соотношение количества ключевых точек, обнаруженных на исходном и искажённом изображениях.
   - **Среднее расстояние сопоставления** – среднее евклидово расстояние между соответствующими точками.
   - **Косинусная схожесть** – среднее значение косинусного сходства между дескрипторами сопоставленных точек.
   - **Время обработки** – вычисляется время, затраченное на выполнение алгоритма.

4. **Сохранение и визуализация результатов:**  
   Результаты сохраняются в CSV-файлы (`saved_points.csv`, `saved_data.csv`), а также генерируются изображения с нарисованными соответствиями ключевых точек. Функция `plot_metrics()` используется для построения графиков, демонстрирующих зависимость метрик от искажений.

5. **Параллельная обработка:**  
   Скрипт использует модуль `multiprocessing` для параллельной обработки нескольких наборов изображений, что позволяет ускорить вычисления при наличии большого количества данных.

## Запуск проекта

Для запуска проекта необходимо выполнить скрипт `search_points.py`. Перед запуском убедитесь, что:
- Все необходимые библиотеки (OpenCV, NumPy, scikit-learn) установлены.
- Изображения для сравнения находятся в соответствующих папках (например, `image_1`, `image_2`, …, `image_7`).
- Файл с оригинальным изображением называется `original_image.jpg`, а файл для сравнительного анализа – `compared_image.jpg` (или отсутствует, если проводятся эксперименты с искажёнными изображениями).

